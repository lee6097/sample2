<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Î≥ëÎèôÎ∑∞ Î™®Ïùò ÌéòÏù¥ÏßÄ</title>
<style>
  :root{
    --navy-900:#061528;
    --navy-800:#0c2137;
    --navy-700:#12314c;
    --accent:#2db1ff;
    --accent-dark:#1f6fa5;
    --text-light:#f6f9ff;
    --text-muted:#90a8bf;
  }
  *{box-sizing:border-box;font-family:"Noto Sans KR","Segoe UI",sans-serif;}
  body{margin:0;background:#08182a;color:var(--text-light);height:100vh;display:flex;}
  .app{flex:1;display:flex;min-height:100vh;}

  /* ---------- LEFT PANEL ---------- */
  .sidebar{
    width:360px;
    background:linear-gradient(180deg,#14314b 0%,#08192b 100%);
    padding:18px;
    display:flex;
    flex-direction:column;
    gap:16px;
    border-right:1px solid rgba(0,0,0,.6);
  }
  .search-row{display:flex;align-items:center;gap:10px;}
  .search-label{
    font-size:15px;
    font-weight:600;
    color:var(--text-light);
    min-width:70px;
  }
  .search-box{
    flex:0 0 50%;   /* Ìè≠ÏùÑ Ï†ïÌôïÌûà 50%Î°ú Í≥†Ï†ï */
    max-width:50%;
    min-width:150px;
    display:flex;
    gap:8px;
  }
  .search-box input{
    flex:1;
    border:1px solid rgba(255,255,255,.08);
    border-radius:6px;
    padding:10px 12px;
    background:#031423;
    color:var(--text-light);
    font-size:15px;
  }
  .search-box button{
    width:44px;height:40px;border:none;border-radius:6px;
    background:var(--accent);color:#042133;font-size:18px;font-weight:700;cursor:pointer;
  }
  .patient-card{
    display:none;
    flex-direction:column;
    gap:6px;
    padding:14px;
    border-radius:10px;
    background:rgba(255,255,255,.05);
    box-shadow:0 10px 25px rgba(0,0,0,.35);
  }
  .patient-card.active{display:flex;}
  .patient-card .id-line{font-size:13px;color:var(--text-muted);}
  .patient-card .name-line{font-size:22px;font-weight:600;}
  .patient-meta{
    display:grid;
    grid-template-columns:repeat(2,minmax(0,1fr));
    gap:4px 10px;
    font-size:13px;
    color:var(--text-muted);
  }
  .history-list{
    flex:1;
    border-radius:10px;
    background:rgba(0,0,0,.25);
    padding:10px;
    overflow:auto;
  }
  .history-item{
    padding:10px 12px;
    border-radius:8px;
    margin-bottom:6px;
    background:rgba(0,0,0,.2);
    border-left:3px solid transparent;
    cursor:pointer;
    transition:.2s;
  }
  .history-item:hover{background:rgba(0,0,0,.4);}
  .history-item.active{
    border-left-color:var(--accent);
    background:rgba(45,177,255,.16);
  }
  .history-date{font-weight:600;font-size:15px;}
  .history-dept{font-size:12px;color:var(--text-muted);}

  /* ---------- MIDDLE BAR ---------- */
  .middle-bar{
    width:120px;
    background:#0b253a;
    border-right:1px solid rgba(0,0,0,.6);
    display:flex;
    flex-direction:column;
    padding:14px 10px;
  }
  .area-buttons,.profile-links{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .profile-section{
    margin-top:28px;
    flex:1;
    display:flex;
    flex-direction:column;
  }
  .area-btn{
    width:100%;
    border:none;
    border-radius:6px;
    padding:7px 8px;
    background:rgba(255,255,255,.08);
    color:var(--text-muted);
    font-size:12px;
    cursor:pointer;
    text-align:left;
  }
  .area-btn.disabled{opacity:.35;cursor:not-allowed;}
  .area-btn.active{
    background:var(--accent);
    color:#072843;
    font-weight:600;
  }
  .profile-link{
    font-size:12px;
    color:var(--text-muted);
    padding:5px 2px;
    cursor:pointer;
    border-radius:4px;
  }
  .profile-link:hover{color:#d8e6f5;}
  .profile-link.active{
    color:#04213a;
    background:var(--accent);
    padding:5px 6px;
    font-weight:600;
  }
  .profile-links{flex:1;overflow:auto;}

  /* ---------- MAIN AREA ---------- */
  .main{
    flex:1;
    display:flex;
    flex-direction:column;
    background:#edf2fb;
  }
  .main-header{
    background:#dbe3f0;
    border-bottom:1px solid #c7d2e2;
    padding:14px 24px 10px;
  }
  .breadcrumb{color:#24364f;font-size:15px;font-weight:600;margin-bottom:10px;min-height:24px;}
  .subnav{
    display:flex;
    gap:6px;
    overflow-x:auto;
    padding-bottom:4px;
    min-height:34px;
  }
  .subnav::-webkit-scrollbar{height:6px;}
  .subnav::-webkit-scrollbar-thumb{background:#b5c5d8;border-radius:3px;}
  .sub-btn{
    border:none;
    border-radius:6px;
    padding:6px 12px;
    background:#c7d4e6;
    color:#2c405b;
    font-size:12px;
    cursor:pointer;
    white-space:nowrap;
  }
  .sub-btn.active{
    background:var(--accent-dark);
    color:#fff;
    font-weight:600;
  }
  .viewer{
    flex:1;
    padding:20px 24px;
    overflow:auto;
    background:linear-gradient(180deg,#fff 0%,#e6edf9 100%);
  }
  .document-panel{
    background:#fff;
    border-radius:12px;
    border:1px solid #cfd8e6;
    box-shadow:0 15px 30px rgba(16,43,83,.12);
    padding:24px;
    min-height:calc(100vh - 140px);
    color:#1d2f45;
    line-height:1.8;
    white-space:pre-line;
    overflow:auto;
  }
</style>
</head>
<body>
<div class="app">
  <!-- LEFT SIDEBAR -->
  <aside class="sidebar">
    <div class="search-row">
      <span class="search-label">ÌôòÏûêÎ≤àÌò∏</span>
      <div class="search-box">
        <input id="patientInput" placeholder="ÌôòÏûêÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
        <button id="searchBtn">üîç</button>
      </div>
    </div>

    <div id="patientCard" class="patient-card">
      <div class="id-line" id="cardId"></div>
      <div class="name-line" id="cardName"></div>
      <div class="patient-meta">
        <div>ÏÑ±Î≥Ñ/ÎÇòÏù¥: <span id="cardDemo"></span></div>
        <div>ÌòàÏï°Ìòï: <span id="cardBlood"></span></div>
        <div>Ï£ºÏπòÏùò: <span id="cardDoctor"></span></div>
      </div>
    </div>

    <div id="historyList" class="history-list"></div>
  </aside>

  <!-- MIDDLE BAR -->
  <div class="middle-bar">
    <div class="area-buttons" id="areaButtons"></div>
    <div class="profile-section">
      <div class="profile-links" id="profileLinks"></div>
    </div>
  </div>

  <!-- MAIN -->
  <main class="main">
    <div class="main-header">
      <div class="breadcrumb" id="breadcrumb"></div>
      <div class="subnav" id="subNav"></div>
    </div>
    <div class="viewer" id="viewer">
      <div class="document-panel"></div>
    </div>
  </main>
</div>

<script>
  const areaOrder=["Ïô∏Îûò","Î≥ëÎèô","ÏùëÍ∏â","ÌÜµÌï©","Îã§ÌïôÏ†ú"];
  const areaTemplates={
    "Ïô∏Îûò":["Ï≤òÎ∞©","Ï¥àÏßÑ","Ïû¨ÏßÑ"],
    "Î≥ëÎèô":["Í≤ΩÍ≥ºÏ†ÑÏ≤¥","ÏùòÏÇ¨Ï≤òÎ∞©","ÏûÖÏõêÍ∏∞Î°ù","ÏûÑÏÉÅÍ¥ÄÏ∞∞","ÏàòÌòàÍ∏∞Î°ù","ÏòÅÏñëÍ∏∞Î°ù","Ìá¥ÏõêÏöîÏïΩ","ÌòëÏßÑÍ∏∞Î°ù","ÎèôÏùòÏÑú","Í∞ÑÌò∏Í∏∞Î°ù","Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)"],
    "ÏùëÍ∏â":["ÏùòÏÇ¨Ï≤òÎ∞©","ER","Í∞ÑÌò∏Í∏∞Î°ù","ÎèôÏùòÏÑú","Í≥ºÍ±∞Í∏∞Î°ù","ÏùëÍ∏âÏã§Ï†ÑÎ¨∏ÏùòÍ∏∞Î°ù","Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùëÍ∏â)","ÏûÑÏÉÅÍ¥ÄÏ∞∞"],
    "ÌÜµÌï©":["Í≤ΩÍ≥ºÏ†ÑÏ≤¥","ÏùòÏÇ¨Ï≤òÎ∞©","ÏûÖÏõêÍ∏∞Î°ù","ÏûÑÏÉÅÍ¥ÄÏ∞∞","ÏàòÌòàÍ∏∞Î°ù","ÏòÅÏñëÍ∏∞Î°ù","Ìá¥ÏõêÏöîÏïΩ","ÌòëÏßÑÍ∏∞Î°ù","ÎèôÏùòÏÑú","Í∞ÑÌò∏Í∏∞Î°ù","Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)"],
    "Îã§ÌïôÏ†ú":["Îã§ÌïôÏ†ú"]
  };
  const profileList=["OCS","ÌôòÏûêÏ†ïÎ≥¥","Í≤ÄÏÇ¨Í≤∞Í≥º","PACS","CIS","ÏÉÅÎ≥ëÏù¥Î†•","ÏàòÏà†Ïù¥Î†•","ÌÉÄÎ≥ëÏõê(Ïô∏Î∂Ä)","Ï≤òÎ∞©Ï°∞Ìöå","ÏßÑÎ£åÏöîÏïΩ","ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç","Ìá¥ÏõêÏöîÏïΩ(Ï†ÑÏ≤¥)"];

  const patients={
    "01076990":{
      id:"01076990",
      name:"ÍπÄÏßÑÏàô",
      gender:"F",
      age:44,
      blood:"B+",
      doctor:"ÍπÄÌïúÏó¥",
      histories:[
        {
          key:"h1",
          label:"2025-10-17 GE",
          dept:"GE",
          categories:{
            "Î≥ëÎèô":{
              "Í≤ΩÍ≥ºÏ†ÑÏ≤¥":"Ïó¨Í∏∞Ïóê Í≤ΩÍ≥ºÏ†ÑÏ≤¥ ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÏùòÏÇ¨Ï≤òÎ∞©":"Ïó¨Í∏∞Ïóê ÏùòÏÇ¨Ï≤òÎ∞© ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÏûÖÏõêÍ∏∞Î°ù":"Ïó¨Í∏∞Ïóê ÏûÖÏõêÍ∏∞Î°ù ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"Ïó¨Í∏∞Ïóê ÏûÑÏÉÅÍ¥ÄÏ∞∞ ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÏàòÌòàÍ∏∞Î°ù":"Ïó¨Í∏∞Ïóê ÏàòÌòàÍ∏∞Î°ù ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÏòÅÏñëÍ∏∞Î°ù":"Ïó¨Í∏∞Ïóê ÏòÅÏñëÍ∏∞Î°ù ÎÇ¥Ïö© ÏûÖÎ†•",
              "Ìá¥ÏõêÏöîÏïΩ":"Ïó¨Í∏∞Ïóê Ìá¥ÏõêÏöîÏïΩ ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÌòëÏßÑÍ∏∞Î°ù":"Ïó¨Í∏∞Ïóê ÌòëÏßÑÍ∏∞Î°ù ÎÇ¥Ïö© ÏûÖÎ†•",
              "ÎèôÏùòÏÑú":"Ïó¨Í∏∞Ïóê ÎèôÏùòÏÑú ÎÇ¥Ïö© ÏûÖÎ†•",
              "Í∞ÑÌò∏Í∏∞Î°ù":"Ïó¨Í∏∞Ïóê Í∞ÑÌò∏Í∏∞Î°ù ÎÇ¥Ïö© ÏûÖÎ†•",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)":"Ïó¨Í∏∞Ïóê Ï¥àÍ∏∞ÌèâÍ∞Ä ÎÇ¥Ïö© ÏûÖÎ†•"
            },
            "ÏùëÍ∏â":{
              "ÏùòÏÇ¨Ï≤òÎ∞©":"ÏùëÍ∏â ÏùòÏÇ¨Ï≤òÎ∞© ÏòàÏãú",
              "ER":"ER Í∏∞Î°ù ÏòàÏãú",
              "Í∞ÑÌò∏Í∏∞Î°ù":"Í∞ÑÌò∏Í∏∞Î°ù ÏòàÏãú",
              "ÎèôÏùòÏÑú":"ÏùëÍ∏â ÎèôÏùòÏÑú ÏòàÏãú",
              "Í≥ºÍ±∞Í∏∞Î°ù":"Í≥ºÍ±∞Í∏∞Î°ù ÏòàÏãú",
              "ÏùëÍ∏âÏã§Ï†ÑÎ¨∏ÏùòÍ∏∞Î°ù":"Ï†ÑÎ¨∏Ïùò Í∏∞Î°ù ÏòàÏãú",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùëÍ∏â)":"ÏùëÍ∏â Ï¥àÍ∏∞ÌèâÍ∞Ä ÏòàÏãú",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"ÏùëÍ∏â ÏûÑÏÉÅÍ¥ÄÏ∞∞ ÏòàÏãú"
            },
            "Ïô∏Îûò":{
              "Ï≤òÎ∞©":"Ïô∏Îûò Ï≤òÎ∞© Î©îÎ™®",
              "Ï¥àÏßÑ":"Ï¥àÏßÑ Í∏∞Î°ù",
              "Ïû¨ÏßÑ":"Ïû¨ÏßÑ Í∏∞Î°ù"
            },
            "ÌÜµÌï©":{
              "Í≤ΩÍ≥ºÏ†ÑÏ≤¥":"ÌÜµÌï© Í≤ΩÍ≥º Ï†ÑÏ≤¥",
              "ÏùòÏÇ¨Ï≤òÎ∞©":"ÌÜµÌï© ÏùòÏÇ¨Ï≤òÎ∞©",
              "ÏûÖÏõêÍ∏∞Î°ù":"ÌÜµÌï© ÏûÖÏõê Í∏∞Î°ù",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"ÌÜµÌï© ÏûÑÏÉÅÍ¥ÄÏ∞∞",
              "ÏàòÌòàÍ∏∞Î°ù":"ÌÜµÌï© ÏàòÌòàÍ∏∞Î°ù",
              "ÏòÅÏñëÍ∏∞Î°ù":"ÌÜµÌï© ÏòÅÏñëÍ∏∞Î°ù",
              "Ìá¥ÏõêÏöîÏïΩ":"ÌÜµÌï© Ìá¥ÏõêÏöîÏïΩ",
              "ÌòëÏßÑÍ∏∞Î°ù":"ÌÜµÌï© ÌòëÏßÑÍ∏∞Î°ù",
              "ÎèôÏùòÏÑú":"ÌÜµÌï© ÎèôÏùòÏÑú",
              "Í∞ÑÌò∏Í∏∞Î°ù":"ÌÜµÌï© Í∞ÑÌò∏Í∏∞Î°ù",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)":"ÌÜµÌï© Ï¥àÍ∏∞ÌèâÍ∞Ä"
            },
            "Îã§ÌïôÏ†ú":{
              "Îã§ÌïôÏ†ú":"Îã§ÌïôÏ†ú ÌöåÏùò ÎÖ∏Ìä∏"
            }
          }
        },
        {
          key:"h2",
          label:"2025-08-01 NR",
          dept:"NR",
          categories:{
            "Î≥ëÎèô":{
              "Í≤ΩÍ≥ºÏ†ÑÏ≤¥":"Îã§Î•∏ ÎÇ†Ïßú Í≤ΩÍ≥º",
              "Ìá¥ÏõêÏöîÏïΩ":"Îã§Î•∏ ÎÇ†Ïßú Ìá¥ÏõêÏöîÏïΩ"
            },
            "Ïô∏Îûò":{
              "Ïû¨ÏßÑ":"NR Ïû¨ÏßÑ Í∏∞Î°ù"
            }
          }
        }
      ],
      profiles:{
        "OCS":"ÍπÄÏßÑÏàô OCS ÎÇ¥Ïö©",
        "ÌôòÏûêÏ†ïÎ≥¥":"ÍπÄÏßÑÏàô ÌôòÏûêÏ†ïÎ≥¥",
        "Í≤ÄÏÇ¨Í≤∞Í≥º":"ÍπÄÏßÑÏàô Í≤ÄÏÇ¨Í≤∞Í≥º",
        "PACS":"PACS ÏûêÎ¶¨",
        "CIS":"CIS ÎÇ¥Ïö©",
        "ÏÉÅÎ≥ëÏù¥Î†•":"ÏÉÅÎ≥ëÏù¥Î†•",
        "ÏàòÏà†Ïù¥Î†•":"ÏàòÏà†Ïù¥Î†• ÏóÜÏùå",
        "ÌÉÄÎ≥ëÏõê(Ïô∏Î∂Ä)":"Ïô∏Î∂Ä Í∏∞Î°ù",
        "Ï≤òÎ∞©Ï°∞Ìöå":"Ï≤òÎ∞©Ï°∞Ìöå ÎÇ¥Ïö©",
        "ÏßÑÎ£åÏöîÏïΩ":"ÏßÑÎ£åÏöîÏïΩ",
        "ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç":"ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç",
        "Ìá¥ÏõêÏöîÏïΩ(Ï†ÑÏ≤¥)":"Ï†ÑÏ≤¥ Ìá¥ÏõêÏöîÏïΩ"
      }
    },
    "02034412":{
      id:"02034412",
      name:"ÌôçÍ∞ÄÏú®",
      gender:"M",
      age:56,
      blood:"A-",
      doctor:"Ïú§Ï†ïÌõà",
      histories:[
        {
          key:"h3",
          label:"2025-09-15 CS",
          dept:"CS",
          categories:{
            "Î≥ëÎèô":{
              "Í≤ΩÍ≥ºÏ†ÑÏ≤¥":"ÌôçÍ∞ÄÏú® Î≥ëÎèô Í≤ΩÍ≥º Í∏∞Î°ù",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"ÌôçÍ∞ÄÏú® ÏûÑÏÉÅÍ¥ÄÏ∞∞",
              "ÏàòÌòàÍ∏∞Î°ù":"ÌôçÍ∞ÄÏú® ÏàòÌòà",
              "ÏòÅÏñëÍ∏∞Î°ù":"ÌôçÍ∞ÄÏú® ÏòÅÏñëÍ∏∞Î°ù",
              "Ìá¥ÏõêÏöîÏïΩ":"ÌôçÍ∞ÄÏú® Ìá¥ÏõêÏöîÏïΩ",
              "ÌòëÏßÑÍ∏∞Î°ù":"ÌôçÍ∞ÄÏú® ÌòëÏßÑ",
              "ÎèôÏùòÏÑú":"ÌôçÍ∞ÄÏú® ÎèôÏùòÏÑú",
              "Í∞ÑÌò∏Í∏∞Î°ù":"ÌôçÍ∞ÄÏú® Í∞ÑÌò∏Í∏∞Î°ù",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)":"ÌôçÍ∞ÄÏú® Ï¥àÍ∏∞ÌèâÍ∞Ä",
              "ÏùòÏÇ¨Ï≤òÎ∞©":"ÌôçÍ∞ÄÏú® ÏùòÏÇ¨Ï≤òÎ∞©",
              "ÏûÖÏõêÍ∏∞Î°ù":"ÌôçÍ∞ÄÏú® ÏûÖÏõêÍ∏∞Î°ù"
            },
            "ÌÜµÌï©":{
              "Í≤ΩÍ≥ºÏ†ÑÏ≤¥":"ÌÜµÌï© Í≤ΩÍ≥º",
              "ÏùòÏÇ¨Ï≤òÎ∞©":"ÌÜµÌï© Ï≤òÎ∞©",
              "ÏûÖÏõêÍ∏∞Î°ù":"ÌÜµÌï© ÏûÖÏõê",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"ÌÜµÌï© Í¥ÄÏ∞∞",
              "ÏàòÌòàÍ∏∞Î°ù":"ÌÜµÌï© ÏàòÌòà",
              "ÏòÅÏñëÍ∏∞Î°ù":"ÌÜµÌï© ÏòÅÏñë",
              "Ìá¥ÏõêÏöîÏïΩ":"ÌÜµÌï© Ìá¥Ïõê",
              "ÌòëÏßÑÍ∏∞Î°ù":"ÌÜµÌï© ÌòëÏßÑ",
              "ÎèôÏùòÏÑú":"ÌÜµÌï© ÎèôÏùòÏÑú",
              "Í∞ÑÌò∏Í∏∞Î°ù":"ÌÜµÌï© Í∞ÑÌò∏Í∏∞Î°ù",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùºÎ∞ò)":"ÌÜµÌï© Ï¥àÍ∏∞ÌèâÍ∞Ä"
            }
          }
        }
      ],
      profiles:{
        "OCS":"ÌôçÍ∞ÄÏú® OCS",
        "ÌôòÏûêÏ†ïÎ≥¥":"ÌôçÍ∞ÄÏú® Ï†ïÎ≥¥",
        "Í≤ÄÏÇ¨Í≤∞Í≥º":"ÌôçÍ∞ÄÏú® Í≤ÄÏÇ¨",
        "PACS":"ÌôçÍ∞ÄÏú® PACS",
        "CIS":"ÌôçÍ∞ÄÏú® CIS",
        "ÏÉÅÎ≥ëÏù¥Î†•":"ÌôçÍ∞ÄÏú® ÏÉÅÎ≥ë",
        "ÏàòÏà†Ïù¥Î†•":"ÌôçÍ∞ÄÏú® ÏàòÏà†",
        "ÌÉÄÎ≥ëÏõê(Ïô∏Î∂Ä)":"ÌôçÍ∞ÄÏú® Ïô∏Î∂Ä",
        "Ï≤òÎ∞©Ï°∞Ìöå":"ÌôçÍ∞ÄÏú® Ï≤òÎ∞©Ï°∞Ìöå",
        "ÏßÑÎ£åÏöîÏïΩ":"ÌôçÍ∞ÄÏú® ÏöîÏïΩ",
        "ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç":"ÌôçÍ∞ÄÏú® ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç",
        "Ìá¥ÏõêÏöîÏïΩ(Ï†ÑÏ≤¥)":"ÌôçÍ∞ÄÏú® Ìá¥Ïõê Ï†ÑÏ≤¥"
      }
    },
    "03128855":{
      id:"03128855",
      name:"ÏµúÎã®ÎπÑ",
      gender:"F",
      age:33,
      blood:"O+",
      doctor:"Î∞ïÏ§ÄÏòÅ",
      histories:[
        {
          key:"h4",
          label:"2024-12-12 ER",
          dept:"ER",
          categories:{
            "ÏùëÍ∏â":{
              "ÏùòÏÇ¨Ï≤òÎ∞©":"ÏµúÎã®ÎπÑ ÏùëÍ∏â Ï≤òÎ∞©",
              "ER":"ÏµúÎã®ÎπÑ ER ÎÇ¥Ïö©",
              "Í∞ÑÌò∏Í∏∞Î°ù":"ÏµúÎã®ÎπÑ Í∞ÑÌò∏Í∏∞Î°ù",
              "ÎèôÏùòÏÑú":"ÏµúÎã®ÎπÑ ÎèôÏùòÏÑú",
              "Í≥ºÍ±∞Í∏∞Î°ù":"ÏµúÎã®ÎπÑ Í≥ºÍ±∞Í∏∞Î°ù",
              "ÏùëÍ∏âÏã§Ï†ÑÎ¨∏ÏùòÍ∏∞Î°ù":"Ï†ÑÎ¨∏Ïùò Í∏∞Î°ù",
              "Ï¥àÍ∏∞ÌèâÍ∞Ä(ÏùëÍ∏â)":"ÏùëÍ∏â Ï¥àÍ∏∞ÌèâÍ∞Ä",
              "ÏûÑÏÉÅÍ¥ÄÏ∞∞":"ÏùëÍ∏â ÏûÑÏÉÅÍ¥ÄÏ∞∞"
            },
            "Îã§ÌïôÏ†ú":{
              "Îã§ÌïôÏ†ú":"ÏµúÎã®ÎπÑ Îã§ÌïôÏ†ú ÎÖ∏Ìä∏"
            }
          }
        }
      ],
      profiles:{
        "OCS":"ÏµúÎã®ÎπÑ OCS",
        "ÌôòÏûêÏ†ïÎ≥¥":"ÏµúÎã®ÎπÑ Ï†ïÎ≥¥",
        "Í≤ÄÏÇ¨Í≤∞Í≥º":"ÏµúÎã®ÎπÑ Í≤ÄÏÇ¨Í≤∞Í≥º",
        "PACS":"ÏµúÎã®ÎπÑ PACS",
        "CIS":"ÏµúÎã®ÎπÑ CIS",
        "ÏÉÅÎ≥ëÏù¥Î†•":"ÏµúÎã®ÎπÑ ÏÉÅÎ≥ë",
        "ÏàòÏà†Ïù¥Î†•":"ÏµúÎã®ÎπÑ ÏàòÏà†",
        "ÌÉÄÎ≥ëÏõê(Ïô∏Î∂Ä)":"ÏµúÎã®ÎπÑ Ïô∏Î∂Ä",
        "Ï≤òÎ∞©Ï°∞Ìöå":"ÏµúÎã®ÎπÑ Ï≤òÎ∞©Ï°∞Ìöå",
        "ÏßÑÎ£åÏöîÏïΩ":"ÏµúÎã®ÎπÑ ÏöîÏïΩ",
        "ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç":"ÏµúÎã®ÎπÑ ÌÜµÌï©ÏπòÎ£åÍ≥ÑÌöç",
        "Ìá¥ÏõêÏöîÏïΩ(Ï†ÑÏ≤¥)":"ÏµúÎã®ÎπÑ Ìá¥Ïõê Ï†ÑÏ≤¥"
      }
    }
  };

  function normalizeData(){
    Object.values(patients).forEach(patient=>{
      patient.histories.forEach(history=>{
        Object.entries(history.categories).forEach(([area,details])=>{
          (areaTemplates[area]||[]).forEach(name=>{
            if(!details[name]) details[name]=`${history.label} ‚ñ∏ ${area} ‚ñ∏ ${name} ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.`;
          });
        });
      });
      profileList.forEach(name=>{
        if(!patient.profiles[name]) patient.profiles[name]=`${patient.name} ‚ñ∏ ${name} ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.`;
      });
    });
  }
  normalizeData();

  let currentPatient=null;
  let currentHistory=null;
  let currentArea=null;
  let currentDetail=null;
  let activeProfile=null;

  const patientInput=document.getElementById("patientInput");
  const searchBtn=document.getElementById("searchBtn");
  const historyList=document.getElementById("historyList");
  const areaButtons=document.getElementById("areaButtons");
  const profileLinks=document.getElementById("profileLinks");
  const subNav=document.getElementById("subNav");
  const breadcrumb=document.getElementById("breadcrumb");
  const viewer=document.getElementById("viewer");
  const patientCard=document.getElementById("patientCard");
  const cardId=document.getElementById("cardId");
  const cardName=document.getElementById("cardName");
  const cardDemo=document.getElementById("cardDemo");
  const cardBlood=document.getElementById("cardBlood");
  const cardDoctor=document.getElementById("cardDoctor");

  function updateBreadcrumb(){
    if(!currentPatient){breadcrumb.textContent="";return;}
    if(activeProfile){breadcrumb.textContent=`${currentPatient.name} ‚ñ∏ ${activeProfile}`;return;}
    const parts=[currentPatient.name];
    if(currentHistory) parts.push(currentHistory.label);
    if(currentArea) parts.push(currentArea);
    if(currentDetail) parts.push(currentDetail);
    breadcrumb.textContent=parts.join(" ‚ñ∏ ");
  }

  function showViewer(text=""){
    viewer.innerHTML=`<div class="document-panel">${text}</div>`;
  }

  function renderHistories(){
    historyList.innerHTML="";
    if(!currentPatient) return;
    currentPatient.histories.forEach(hist=>{
      const div=document.createElement("div");
      div.className="history-item";
      if(currentHistory && hist.key===currentHistory.key) div.classList.add("active");
      div.innerHTML=`<div class="history-date">${hist.label}</div>
                     <div class="history-dept">${hist.dept}</div>`;
      div.onclick=()=>{
        currentHistory=hist;
        currentArea=null;
        currentDetail=null;
        activeProfile=null;
        renderHistories();
        renderAreas();
        renderProfiles();
        renderSubNav();
        updateBreadcrumb();
        showViewer();
      };
      historyList.appendChild(div);
    });
  }

  function renderAreas(){
    areaButtons.innerHTML="";
    areaOrder.forEach(area=>{
      const btn=document.createElement("button");
      btn.className="area-btn";
      btn.textContent=area;
      const enabled=currentHistory && currentHistory.categories[area];
      if(!enabled) btn.classList.add("disabled");
      if(currentArea===area && !activeProfile) btn.classList.add("active");
      btn.onclick=()=>{
        if(!enabled) return;
        activeProfile=null;
        currentArea=area;
        const details=currentHistory.categories[area];
        currentDetail=Object.keys(details)[0]||null;
        renderAreas();
        renderProfiles();
        renderSubNav();
        if(currentDetail) showViewer(details[currentDetail]); else showViewer();
        updateBreadcrumb();
      };
      areaButtons.appendChild(btn);
    });
  }

  function renderProfiles(){
    profileLinks.innerHTML="";
    if(!currentPatient) return;
    profileList.forEach(name=>{
      const div=document.createElement("div");
      div.className="profile-link";
      if(activeProfile===name) div.classList.add("active");
      div.textContent=name;
      div.onclick=()=>{
        if(!currentPatient) return;
        activeProfile=name;
        currentArea=null;
        currentDetail=null;
        renderAreas();
        renderProfiles();
        renderSubNav();
        updateBreadcrumb();
        showViewer(currentPatient.profiles[name]);
      };
      profileLinks.appendChild(div);
    });
  }

  function renderSubNav(){
    subNav.innerHTML="";
    if(activeProfile || !currentArea || !currentHistory) return;
    const details=currentHistory.categories[currentArea];
    Object.keys(details).forEach(name=>{
      const btn=document.createElement("button");
      btn.className="sub-btn";
      btn.textContent=name;
      if(currentDetail===name) btn.classList.add("active");
      btn.onclick=()=>{
        currentDetail=name;
        renderSubNav();
        showViewer(details[name]);
        updateBreadcrumb();
      };
      subNav.appendChild(btn);
    });
  }

  function populateCard(){
    cardId.textContent=`ÌôòÏûêÎ≤àÌò∏ ${currentPatient.id}`;
    cardName.textContent=currentPatient.name;
    cardDemo.textContent=`${currentPatient.gender}/${currentPatient.age}ÏÑ∏`;
    cardBlood.textContent=currentPatient.blood;
    cardDoctor.textContent=currentPatient.doctor;
    patientCard.classList.add("active");
  }

  function handleSearch(){
    const id=patientInput.value.trim();
    const target=patients[id];
    if(!target){alert("Îì±Î°ùÎêú ÌôòÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§.");return;}
    currentPatient=target;
    currentHistory=null;
    currentArea=null;
    currentDetail=null;
    activeProfile=null;
    populateCard();
    renderHistories();
    renderAreas();
    renderProfiles();
    renderSubNav();
    updateBreadcrumb();
    showViewer();
  }

  searchBtn.onclick=handleSearch;
  patientInput.addEventListener("keyup",e=>{if(e.key==="Enter") handleSearch();});
  showViewer();
</script>
</body>
</html>
